version: 2

sources:
  - name: rental_data
    description: "Source data for rental property management company"
    schema: "{{ var('raw_schema', 'raw') }}"
    tables:
      - name: listings
        description: "Property listings with host information, amenities, and review metadata"
        columns:
          - name: id
            description: "Unique ID for this listing. Primary Key."
            tests:
              - unique
              - not_null
          - name: name
            description: "Display name of listing"
          - name: host_id
            description: "Unique ID for the Host who owns this property"
          - name: amenities
            description: "Array of amenities available for guests (JSON parseable)"
          - name: price
            description: "The price of this listing as of the start of the date range in CALENDAR"
      
      - name: calendar
        description: "Daily availability, reservations, and pricing for listings"
        columns:
          - name: listing_id
            description: "Unique ID for the listing to which this row applies. Part of Primary Key."
            tests:
              - not_null
          - name: date
            description: "Date of availability this row describes. Part of Primary Key."
            tests:
              - not_null
          - name: available
            description: "Contains 't' if property is available, 'f' if not"
          - name: reservation_id
            description: "Unique ID for that DATE's reservation. NULL if no reservation"
          - name: price
            description: "The USD price to rent this property on DATE"
          - name: minimum_nights
            description: "Minimum number of nights that must be booked consecutively"
          - name: maximum_nights
            description: "Maximum number of nights that may be booked consecutively"
      
      - name: generated_reviews
        description: "Generated review scores and dates for listings"
        columns:
          - name: id
            description: "Auto-incrementing ID for the dummy reviews data"
          - name: listing_id
            description: "Unique ID for the listing to which this row applies"
            tests:
              - not_null
          - name: review_score
            description: "Generated score of the review, integer 1 to 5"
          - name: review_date
            description: "Generated date of the review"
      
      - name: amenities_changelog
        description: "Historical changes to amenities for listings"
        columns:
          - name: listing_id
            description: "Unique ID for the listing to which this row applies. Part of Primary Key."
            tests:
              - not_null
          - name: change_at
            description: "When the amenities list changed. Part of Primary Key."
            tests:
              - not_null
          - name: amenities
            description: "Array of the amenities available as of the change (JSON parseable)"

